var app=angular.module("cardsApp",["ui.router","ngAnimate","ui-notification"]);app.config(function(r,a,e,t){t.setOptions({delay:3e3,startTop:20,startRight:10,verticalSpacing:20,horizontalSpacing:20,positionX:"right",positionY:"bottom"}),a.hashPrefix(""),e.otherwise("/"),r.state({name:"default",url:"/",templateUrl:"panel.htm"}).state({name:"list",url:"/list",templateUrl:"list.htm"}).state({name:"test",url:"/test",templateUrl:"test.htm"})}),app.service("storage",function(){this.saveCards=function(r){var a=[];return r.forEach(function(r){a.push(JSON.stringify(r))}),localStorage.setItem("fastCards",a.join("|")),!0},this.getCards=function(){var r,a="",e=[],t=!0;return a=localStorage.getItem("fastCards"),""!=a&&null!=a||(a='{"question":"Gdzie urodził się Fryderyk Chopin?","answer":"Żelazowa Wola","active":true}|{"question":"W który roku zmarł Ludwig van Beethoven?","answer":"1827r."}|{"question":"W którym roku urodził się Wolfgang Amadeus Mozart?","answer":"1756r."}|{"question":"Gdzie umarł Johannes Brahms?","answer":"W Wiedniu"}|{"question":"W jakich latach żył Georg Friedrich Händel?","answer":"1685 - 1759"}'),a=a.split("|"),a.forEach(function(a){r=JSON.parse(a),t?(r.active=!0,t=!1):r.active=!1,r.hover=!1,r.success=void 0,e.push(r)}),e}}),app.service("helpers",function(){this.shuffle=function(r){for(var a,e,t=r.length;0!==t;)e=Math.floor(Math.random()*t),t-=1,a=r[t],r[t]=r[e],r[e]=a;return r}}),app.directive("fileread",[function(){return{scope:{fileread:"="},link:function(r,a,e){a.bind("change",function(a){var e=new FileReader;e.onload=function(a){r.$apply(function(){r.fileread=a.target.result})},e.readAsDataURL(a.target.files[0])})}}}]),app.controller("cardsCtrl",function(r,a,e,t,s){var n=this;n.loader=!0,n.image=null,n.imageText=null,n.question="",n.answer="",n.history=[],n.cards=e.getCards(),n.cardsTest=n.cards,n.currentCard=0,n.saveHistory=function(){n.history.push(JSON.stringify(n.cards))},n.backHistory=function(){n.history.length>0&&(n.cards=JSON.parse(n.history[n.history.length-2]),n.history.splice(-1))},n.saveHistory(),n.toggleHover=function(r){n.cards[r].hover?n.cards[r].hover=!1:n.cards[r].hover=!0},n.removeCard=function(r){n.cards[r].active&&(n.changeCard(r+1),n.changeCard(r-1)),r<=n.currentCard&&n.currentCard--,n.cards.splice(r,1),n.saveHistory()},n.addCard=function(){""!=n.question&&""!=n.answer?(n.cards.push({image:n.image,imageText:n.imateText,question:n.question,answer:n.answer}),1==n.cards.length&&(n.cards[0].active=!0,n.currentCard=0),n.image=null,n.imageText=null,n.question="",n.answer="",n.saveHistory()):s.warning("Wprowadź pytanie i odpowiedź!")},n.changeCard=function(r){r>=0&&r<n.cards.length&&(n.cards[n.currentCard].active=!1,n.currentCard=r,n.cards[n.currentCard].active=!0,n.cards.forEach(function(r){r.hover=!1}))},n.testCard=function(r){if(1==r?n.cards[n.currentCard].success=!0:0==r&&(n.cards[n.currentCard].success=!1),n.currentCard+=1,n.currentCard==n.cards.length&&void 0!=r){var a=0,e=0;n.cards.forEach(function(r){1==r.success&&e++,a++,r.success=void 0}),n.currentCard=0,n.cards[n.cards.length-1].active=!1,n.cards[0].active=!0,s.primary("Twój wynik to: "+e+"/"+a)}else n.cards[n.currentCard-1].active=!1,n.cards[n.currentCard-1].hover=!1,n.cards[n.currentCard].active=!0},n.syncCards=function(){e.saveCards(n.cards)&&!n.notiSuccess&&s.success("Zapisano aktualny stan fiszek!")},n.startTest=function(){n.changeCard(0)}});