var app=angular.module("cardsApp",["ui.router","ngAnimate"]);app.config(function(r,e,a){e.hashPrefix(""),a.otherwise("/"),r.state({name:"default",url:"/",templateUrl:"panel.htm"}).state({name:"list",url:"/list",templateUrl:"list.htm"}).state({name:"test",url:"/test",templateUrl:"test.htm"})}),app.service("storage",function(){this.saveCards=function(r){var e=[];return r.forEach(function(r){e.push(JSON.stringify(r))}),localStorage.setItem("fastCards",e.join("|")),!0},this.getCards=function(){var r="",e=[];return r=localStorage.getItem("fastCards"),""!=r&&null!=r||(r='{"question":"Gdzie urodził się Fryderyk Chopin?","answer":"Żelazowa Wola","active":true}|{"question":"W który roku zmarł Ludwig van Beethoven?","answer":"1827r."}|{"question":"W którym roku urodził się Wolfgang Amadeus Mozart?","answer":"1756r."}|{"question":"Gdzie umarł Johannes Brahms?","answer":"W Wiedniu"}|{"question":"W jakich latach żył Georg Friedrich Händel?","answer":"1685 - 1759"}'),r=r.split("|"),r.forEach(function(r){e.push(JSON.parse(r))}),e}}),app.directive("fileread",[function(){return{scope:{fileread:"="},link:function(r,e,a){e.bind("change",function(e){var a=new FileReader;a.onload=function(e){r.$apply(function(){r.fileread=e.target.result})},a.readAsDataURL(e.target.files[0])})}}}]),app.controller("cardsCtrl",function(r,e,a){var t=this;t.loader=!0,t.image=null,t.imageText=null,t.question="",t.answer="",t.history=[],t.notiSuccess=!1,t.notiWarning=!1,t.cards=a.getCards(),t.saveHistory=function(){t.history.push(JSON.stringify(t.cards))},t.backHistory=function(){t.history.length>0&&(t.cards=JSON.parse(t.history[t.history.length-2]),t.history.splice(-1))},t.cards.forEach(function(r,e){r.hover=!1,1==r.active&&(t.currentCard=e)}),t.saveHistory(),t.toggleHover=function(r){t.cards[r].hover?t.cards[r].hover=!1:t.cards[r].hover=!0},t.removeCard=function(r){t.cards[r].active&&(t.changeCard(r+1),t.changeCard(r-1)),r<=t.currentCard&&t.currentCard--,t.cards.splice(r,1),t.saveHistory()},t.addCard=function(){""!=t.question&&""!=t.answer?(t.cards.push({image:t.image,imageText:t.imateText,question:t.question,answer:t.answer}),1==t.cards.length&&(t.cards[0].active=!0,t.currentCard=0),t.image=null,t.imageText=null,t.question="",t.answer="",t.saveHistory()):t.notiWarning||(t.notiWarning=!0,e(function(){t.notiWarning=!1},3e3))},t.changeCard=function(r,e){if(1==e?t.cards[t.currentCard].success=!0:0==e&&(t.cards[t.currentCard].success=!1),r==t.cards.length){var a=0,n=0;t.cards.forEach(function(r){1==r.success&&n++,a++}),alert("Wynik: "+n+"/"+a)}r>=0&&r<t.cards.length&&(t.cards[t.currentCard].active=!1,t.currentCard=r,t.cards[t.currentCard].active=!0,t.cards.forEach(function(r){r.hover=!1}))},t.syncCards=function(){a.saveCards(t.cards)&&!t.notiSuccess&&(t.notiSuccess=!0,e(function(){t.notiSuccess=!1},3e3))}});